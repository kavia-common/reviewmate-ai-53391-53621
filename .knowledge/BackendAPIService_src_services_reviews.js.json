{"is_source_file": true, "format": "JavaScript", "description": "This file contains service functions related to reviews management within the backend of a review platform. It handles synchronization of reviews from external providers, generates automated AI responses to reviews, updates analytics snapshots based on review data, and retrieves paginated reviews for locations.", "external_files": ["../lib/prisma", "./ai", "./integrations", "dayjs"], "external_methods": ["analyzeSentiment", "generateResponse", "fetchProviderReviews"], "published": ["syncLocationReviews", "respondToReview", "getLocationReviews"], "classes": [], "methods": [{"name": "syncLocationReviews(locationId)", "description": "Fetches new reviews for a specific location across all integrations, analyzes sentiment, and upserts them into the database. Also updates the analytics snapshot for the last 30 days.", "scope": "", "scopeKind": ""}, {"name": "respondToReview(reviewId, options = {})", "description": "Generates an AI-based response to a specific review and updates the review record with this response.", "scope": "", "scopeKind": ""}, {"name": "updateAnalytics(locationId, date)", "description": "Calculates review statistics (average rating, sentiment counts) for a location on a given day and updates or creates an analytics snapshot.", "scope": "", "scopeKind": ""}, {"name": "getLocationReviews(locationId, query = {})", "description": "Retrieves paginated reviews for a specific location, including total count.", "scope": "", "scopeKind": ""}], "calls": ["prisma.location.findUnique", "fetchProviderReviews", "analyzeSentiment", "prisma.review.upsert", "prisma.integration.update", "updateAnalytics", "prisma.review.findUnique", "generateResponse", "prisma.review.update", "prisma.review.findMany", "prisma.review.count", "prisma.analyticsSnapshot.upsert"], "search-terms": ["reviews", "sentiment", "AI response", "location reviews sync", "analytics snapshot", "external reviews", "review management"], "state": 2, "file_id": 19, "knowledge_revision": 39, "git_revision": "", "ctags": [{"_type": "tag", "name": "dayjs", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^const dayjs = require('dayjs');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getLocationReviews", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^async function getLocationReviews(locationId, query = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(locationId, query = {})"}, {"_type": "tag", "name": "locationId", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^  const where = { locationId };$/", "language": "JavaScript", "kind": "field", "scope": "getLocationReviews.where", "scopeKind": "class"}, {"_type": "tag", "name": "orderBy", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^  const orderBy = { reviewAt: 'desc' };$/", "language": "JavaScript", "kind": "class", "scope": "getLocationReviews", "scopeKind": "class"}, {"_type": "tag", "name": "prisma", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^const prisma = require('..\\/lib\\/prisma');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "respondToReview", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^async function respondToReview(reviewId, options = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(reviewId, options = {})"}, {"_type": "tag", "name": "reviewAt", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^  const orderBy = { reviewAt: 'desc' };$/", "language": "JavaScript", "kind": "property", "scope": "getLocationReviews.orderBy", "scopeKind": "class"}, {"_type": "tag", "name": "syncLocationReviews", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^  syncLocationReviews,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "syncLocationReviews", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^async function syncLocationReviews(locationId) {$/", "language": "JavaScript", "kind": "function", "signature": "(locationId)"}, {"_type": "tag", "name": "updateAnalytics", "path": "/home/kavia/workspace/code-generation/reviewmate-ai-53391-53621/BackendAPIService/src/services/reviews.js", "pattern": "/^async function updateAnalytics(locationId, date) {$/", "language": "JavaScript", "kind": "function", "signature": "(locationId, date)"}], "hash": "a30f70b6ed2f328545219ccd6724b71e", "format-version": 4, "code-base-name": "BackendAPIService", "filename": "BackendAPIService/src/services/reviews.js", "fields": [{"name": "const where = { locationId };", "scope": "getLocationReviews.where", "scopeKind": "class", "description": "unavailable"}, {"name": "const orderBy = { reviewAt: 'desc' };", "scope": "getLocationReviews.orderBy", "scopeKind": "class", "description": "unavailable"}, {"name": "syncLocationReviews,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"39": ""}]}